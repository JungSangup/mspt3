# MSP T3 - 23-7차


## Docker

- 서버가 Scale-out때 생성되는 컨테이너는 이미지를 기반으로 생성되나요? 원래 있던 컨테이너 레이어에서 쓰기작업이 수행된 내용은 이미지에 없어 복사가 안되는거 아닌가 해서요.
  - 네, 맞습니다. 컨테이너가 생성될때는 이미지의 레이어들(R/O)을 기반으로 새로운 컨테이너 레이어(R/W)가 하나 추가되면서 생성됩니다.
  - 기존의 이미지에서 쓰기작업이 수행된 내용은 기본적으로는 다른 컨테이너에 복사되지 않습니다.
  - 그래서, 그런 경우는 Volume/Bind mount를 사용해서 공유하게 됩니다. (3장에서 배웁니다.)

- 컨테이너는 OS에서 제공하는 기능인가요?
  - 네, 맞습니다. 리눅스 커널의 기능입니다.
  - 도커는 이걸 좀 더 쉽게 사용할 수 있도록 만들어진 플랫폼입니다.

- 컨테이너 1개에 앱 1개 (1:1) 로 구성되는건가요?
  - 네, 맞습니다.
  - 그게 권장사항 입니다.
  - 컨테이너의 사이즈를 줄이고, 서로간의 의존성도 배제하는 방법입니다.
  - MSA에서의 개념과도 관련이 있습니다.
 
- 최종 이미지는 대체적으로 어느정도 용량 이하가 적정한가요?
  - 이건 사실 경우에 따라 달라서 정답은 없습니다.
  - 가능하면 작게 만들면 좋긴 하지만, 복잡한 시스템이라면 사이즈가 커질 수 밖에 없습니다.
  - 아래는 ChatGPT (GPT4)의 대답입니다. 참고하세요. 😁
```
도커 컨테이너의 이미지 사이즈에 대한 "적정 사이즈"는 상대적이며 다양한 요인에 따라 달라질 수 있습니다. 그렇지만 일반적으로 도커 이미지를 작게 유지하는 것이 좋습니다. 다음은 이유와 관련 팁입니다:

이유:

더 빠른 배포: 작은 이미지는 빠르게 전송, 저장, 시작할 수 있습니다.
보안: 최소한의 컴포넌트만 포함시키면 공격 영역이 줄어들며, 불필요한 소프트웨어나 라이브러리가 없기 때문에 보안 위협이 줄어듭니다.
저장 공간: 작은 이미지는 디스크 공간을 덜 차지합니다.
적정 사이즈를 위한 팁:

멀티 스테이지 빌드 사용: 중간 빌드 단계에서 필요한 도구나 라이브러리는 최종 이미지에 포함시키지 않을 수 있습니다.
최소화된 베이스 이미지 사용: 예를 들면, alpine은 매우 작은 리눅스 기반 이미지입니다.
불필요한 파일 제거: 빌드 캐시, 로그, 임시 파일 등 불필요한 파일은 삭제하세요.
최적화된 패키지 설치: 패키지를 설치할 때 불필요한 의존성을 제외하도록 최적화합니다.
그렇다고 해서 모든 이미지가 극도로 작아야 하는 것은 아닙니다. 애플리케이션의 필요성과 목적에 따라 이미지 사이즈가 달라질 수 있습니다. 예를 들어, 머신 러닝 모델이 포함된 이미지는 자체적으로 크기가 클 수 있습니다.

따라서 "적정 사이즈"는 해당 이미지가 어떤 목적으로 사용되는지, 어떤 환경에서 배포되는지 등 여러 요인을 고려하여 결정해야 합니다.
```


---

## Kubernetes
